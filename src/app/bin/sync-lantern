#!/usr/bin/env node

console.log("starting sync for lantern...");

var PouchDB = require('lantern-serve').PouchDB;
var local_db = PouchDB("http://localhost/db/lantern");
var lantern_db = PouchDB("http://lantern.local/db/lantern");


var sync = local_db.sync(lantern_db, { 
        live: false, 
        retry: false
    })
    .on('change', function (change) {
        if (change.direction) {
            console.log("[sync] " + change.direction  + " docs: " + 
                    change.change.docs_read + " read / " + 
                    change.change.docs_written + " written"
                );
        }
        else {
            console.log("[sync] change: ", change);
        }
    })
    .on('complete', function() {
        console.log("[sync] complete");
        process.exit(0);
    })
    .on('error', function (err) {
        console.log("err: ", err);
        process.exit(1);
    });